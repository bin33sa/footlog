<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.fl.mapper.AdminMypageMapper">

	<!-- 구장 삭제 -->
	<update id="DeleteStadium"
        parameterType="long">
	    UPDATE stadium
	    SET
	        is_deleted = 1
	    WHERE stadium_code = #{stadiumCode}
	</update>
	<!-- 구장 인서트 -->
	<insert id="InsertStadium"
		parameterType="com.fl.model.StadiumDTO">

		INSERT INTO stadium (
		lat,
		lng,
		stadium_code,
		stadium_name,
		region,
		phone_number,
		description,
		stadium_image,
		rating,
		price
		) VALUES (
		#{lat},
		#{lng},
		seq_stadium.NEXTVAL,
		#{stadiumName},
		#{region},
		#{phoneNumber},
		#{description},
		#{stadiumImage},
		#{rating},
		#{price}
		)
	</insert>
	<!-- 구장 업데이트 -->
	<update id="UpdateStadium"
        parameterType="com.fl.model.StadiumDTO">

	    UPDATE stadium
	    SET
	    	lat = #{lat},
	    	lng = #{lng},
	        stadium_name   = #{stadiumName},
	        region         = #{region},
	        phone_number   = #{phoneNumber},
	        description    = #{description},
	        stadium_image  = #{stadiumImage},
	        rating         = #{rating},
	        price          = #{price}
	    WHERE stadium_code = #{stadiumCode}

	</update>
	
	

	<!-- 구단 전체 조회 -->
	<select id="CountTeamAll" resultType="com.fl.model.TeamDTO">
		SELECT
		*
		FROM team
	</select>

	<!-- 구단 관리 구단주명 포함 조회 -->
	<select id="ListTeamAll" resultType="com.fl.model.TeamDTO">
		SELECT
		t.team_name AS team_name,
		t.contact_number AS contact_number,
		t.region,
		t.member_count AS member_count,
		m.member_name AS leader_name
		FROM team t
		JOIN member_team mt
		ON t.team_code = mt.team_code
		JOIN member m
		ON mt.member_code = m.member_code
		WHERE mt.role_level >= 10
	</select>


	<!-- 구장 전체 조회 -->
	<select id="CountStadiumAll"
		resultType="com.fl.model.StadiumDTO">

		SELECT
		*
		FROM stadium
	</select>

	<!-- 구장 관리 구장 조회 -->
	<select id="ListStadiumAll" resultType="com.fl.model.StadiumDTO">
		SELECT
		stadium_code AS stadiumCode,
		stadium_name AS stadiumName,
		region,
		description,
		rating,
		price,
		is_deleted AS is_deleted
		FROM stadium
	</select>
	
	<!-- 특정 구장 조회 -->
	<select id="ListStadiumFind" 
		parameterType = "long"
		resultType="com.fl.model.StadiumDTO">
		SELECT
		stadium_code AS stadiumCode,
		stadium_name AS stadiumName,
		region,
		description,
		rating,
		price,
		lat,
		lng,
		phone_number AS phoneNumber,
		stadium_image AS stadiumImage
		FROM stadium
		WHERE stadium_code = #{stadiumCode}
	</select>

	<!-- 멤버 전체 조회 -->
	<select id="CountMemberAll" resultType="com.fl.model.MemberDTO">
		SELECT
		*
		FROM member
	</select>

	<!-- 멤버 관리 멤버 조회 -->
	<select id="ListMemberAll" resultType="com.fl.model.MemberDTO">
		SELECT
		member_id AS member_id,
		member_name AS member_name,
		phone_number AS phone_number,
		email AS email,
		is_deleted AS is_deleted
		FROM member
	</select>
	
	<!-- 타임슬롯 조회 -->
	<select id="ListTimeCode" 
		resultType="com.fl.model.TimeCodeDTO">
		SELECT
		time_code,
		label
		FROM time_code
	</select>
	
	<!-- 구장타임슬롯 저장 -->
	<insert id="InsertTimeSlot"
		parameterType="com.fl.model.StadiumTimeSlotDTO">

		INSERT INTO stadium_timeslot (
		stadium_code,
		time_code,
		day_type
		) VALUES (
		#{stadiumCode},
		#{timeCode},
		#{dayType}
		)
	</insert>
	
	<!-- 타임슬롯삭제 -->
	<delete id="DeleteTimeSlot" parameterType="long">
    DELETE FROM stadium_timeslot
    WHERE stadium_code = #{stadiumCode}
	</delete>
	
	
</mapper>